{"map":"{\"version\":3,\"sources\":[\"webpack/bootstrap\",\"C:/Users/Mach1/Documents/Projects/TV Extender/src\\\\content.js\",\"C:/Users/Mach1/Documents/Projects/TV Extender/src\\\\modules\\\\content_utils.js\"],\"names\":[\"installedModules\",\"__webpack_require__\",\"moduleId\",\"exports\",\"module\",\"i\",\"l\",\"modules\",\"call\",\"m\",\"c\",\"d\",\"name\",\"getter\",\"o\",\"Object\",\"defineProperty\",\"enumerable\",\"get\",\"r\",\"Symbol\",\"toStringTag\",\"value\",\"t\",\"mode\",\"__esModule\",\"ns\",\"create\",\"key\",\"bind\",\"n\",\"object\",\"property\",\"prototype\",\"hasOwnProperty\",\"p\",\"s\",\"utils\",\"console\",\"log\",\"port\",\"chrome\",\"runtime\",\"connect\",\"onMessage\",\"addListener\",\"msg\",\"sender\",\"type\",\"payload\",\"observer\",\"MutationObserver\",\"mutations\",\"forEach\",\"mutation\",\"mutantMatch\",\"addedNodes\",\"node\",\"alertDTS\",\"Date\",\"cells\",\"innerText\",\"withinSeconds\",\"correctTVDTS\",\"alertStr\",\"String\",\"order\",\"extractOrder\",\"postMessage\",\"alert\",\"rhs\",\"document\",\"getElementsByClassName\",\"observe\",\"attributes\",\"characterData\",\"subtree\",\"childList\",\"tvDTS\",\"corrected\",\"setDate\",\"getDate\",\"setHours\",\"getHours\",\"setMinutes\",\"getMinutes\",\"setSeconds\",\"getSeconds\",\"dts\",\"seconds\",\"now\",\"dtsDiff\",\"Math\",\"abs\",\"text\",\"idxS\",\"search\",\"idxE\",\"length\",\"JSON\",\"parse\",\"slice\",\"e\",\"target\",\"localName\",\"parentElement\",\"className\",\"previousElementSibling\",\"textContent\"],\"mappings\":\"aACA,IAAAA,KAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAC,QAGA,IAAAC,EAAAJ,EAAAE,IACAG,EAAAH,EACAI,GAAA,EACAH,YAUA,OANAI,EAAAL,GAAAM,KAAAJ,EAAAD,QAAAC,EAAAA,EAAAD,QAAAF,GAGAG,EAAAE,GAAA,EAGAF,EAAAD,QAKAF,EAAAQ,EAAAF,EAGAN,EAAAS,EAAAV,EAGAC,EAAAU,EAAA,SAAAR,EAAAS,EAAAC,GACAZ,EAAAa,EAAAX,EAAAS,IACAG,OAAAC,eAAAb,EAAAS,GAA0CK,YAAA,EAAAC,IAAAL,KAK1CZ,EAAAkB,EAAA,SAAAhB,GACA,oBAAAiB,QAAAA,OAAAC,aACAN,OAAAC,eAAAb,EAAAiB,OAAAC,aAAwDC,MAAA,WAExDP,OAAAC,eAAAb,EAAA,cAAiDmB,OAAA,KAQjDrB,EAAAsB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAArB,EAAAqB,IACA,EAAAE,EAAA,OAAAF,EACA,GAAA,EAAAE,GAAA,iBAAAF,GAAAA,GAAAA,EAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFA1B,EAAAkB,EAAAO,GACAX,OAAAC,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,MAAAA,IACzC,EAAAE,GAAA,iBAAAF,EAAA,IAAA,IAAAM,KAAAN,EAAArB,EAAAU,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAzB,EAAA6B,EAAA,SAAA1B,GACA,IAAAS,EAAAT,GAAAA,EAAAqB,WACA,WAA2B,OAAArB,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAH,EAAAU,EAAAE,EAAA,IAAAA,GACAA,GAIAZ,EAAAa,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD/B,EAAAkC,EAAA,GAIAlC,EAAAA,EAAAmC,EAAA,2GC/EYC,6JAHZC,QAAQC,IAAI,4DACZ,IAAIC,EAAOC,OAAOC,QAAQC,SAAS/B,KAAM,mBAIzC4B,EAAKI,UAAUC,YAAY,SAASC,EAAKC,GACrC,GAAe,WAAZD,EAAIE,KAAkB,CACrBV,QAAQC,IAAIO,EAAIG,SAChBX,QAAQC,IAAI,0BACZ,IAAIW,EAAU,IAAIC,iBAAiB,SAASC,GACxCA,EAAUC,QAAQ,SAASC,GACpBjB,EAAMkB,YAAYD,KACjBhB,QAAQC,IAAIe,GACZA,EAASE,WAAWH,QAAQ,SAASI,GAIjC,IAAIC,EAAW,IAAIC,KAAKF,EAAKG,MAAM,GAAGC,WACtC,GAAGxB,EAAMyB,cAAczB,EAAM0B,aAAaL,GAAW,IAAK,CACtD,IAAIM,EAAW,IAAIC,OAAOR,EAAKG,MAAM,GAAGC,WACpCK,EAAQ7B,EAAM8B,aAAaH,GACnB,MAATE,EAEC1B,EAAK4B,aAAapB,KAAK,QAASC,QAAQiB,IAExCG,MAAM,yDAOV/B,QAAQC,IAAI,kDAO5B+B,EAAMC,SAASC,uBAAuB,uBAAuB,GAEjEtB,EAASuB,QAAQH,GADHI,YAAW,EAAOC,eAAc,EAAOC,SAAQ,EAAMC,WAAU,yHCxCrF,gEAwDQd,aAjDR,SAAsBe,GAClB,IAAIC,EAAY,IAAIpB,KAKpB,OAJAoB,EAAUC,QAAQF,EAAMG,WACxBF,EAAUG,SAASJ,EAAMK,YACzBJ,EAAUK,WAAWN,EAAMO,cAC3BN,EAAUO,WAAWR,EAAMS,cACpBR,KA2CWjB,cAvCtB,SAAuB0B,EAAKC,GACxB,IAAIC,EAAM,IAAI/B,KACVgC,EAAUC,KAAKC,IAAIH,EAAMF,GAK7B,OAJAlD,QAAQC,IAAImD,GACZpD,QAAQC,IAAIiD,GACZlD,QAAQC,IAAI,uBAAyBoD,EAAU,OAEvCA,EAAU,KAAQF,MAgCOtB,aA3BrC,SAAsB2B,GAClB,IAAIC,EAAOD,EAAKE,OAAO,QACnBC,EAAOH,EAAKE,OAAO,QACvB,GAAGD,GAAQ,GAAKE,GAAQ,GAAKF,EAAO,EAAID,EAAKI,OACzC,IACI,IAAIhC,EAAQiC,KAAKC,MAAMN,EAAKO,MAAMN,EAAO,EAAGE,IAE5C,OADA3D,QAAQC,IAAI2B,GACLA,EACT,MAAMoC,GACJhE,QAAQC,IAAI,6BAA+B+D,GAInD,OADAhE,QAAQC,IAAI,4CAA8CuD,GACnD,QAcwCvC,YAVnD,SAAqBD,GACjB,MAAgC,SAA7BA,EAASiD,OAAOC,WACmC,cAA3ClD,EAASiD,OAAOE,cAAcC,WAEwB,8BAAtDpD,EAASiD,OAAOI,uBAAuBC\",\"sourcesContent\":[\" \\t// The module cache\\n \\tvar installedModules = {};\\n\\n \\t// The require function\\n \\tfunction __webpack_require__(moduleId) {\\n\\n \\t\\t// Check if module is in cache\\n \\t\\tif(installedModules[moduleId]) {\\n \\t\\t\\treturn installedModules[moduleId].exports;\\n \\t\\t}\\n \\t\\t// Create a new module (and put it into the cache)\\n \\t\\tvar module = installedModules[moduleId] = {\\n \\t\\t\\ti: moduleId,\\n \\t\\t\\tl: false,\\n \\t\\t\\texports: {}\\n \\t\\t};\\n\\n \\t\\t// Execute the module function\\n \\t\\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\\n\\n \\t\\t// Flag the module as loaded\\n \\t\\tmodule.l = true;\\n\\n \\t\\t// Return the exports of the module\\n \\t\\treturn module.exports;\\n \\t}\\n\\n\\n \\t// expose the modules object (__webpack_modules__)\\n \\t__webpack_require__.m = modules;\\n\\n \\t// expose the module cache\\n \\t__webpack_require__.c = installedModules;\\n\\n \\t// define getter function for harmony exports\\n \\t__webpack_require__.d = function(exports, name, getter) {\\n \\t\\tif(!__webpack_require__.o(exports, name)) {\\n \\t\\t\\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\\n \\t\\t}\\n \\t};\\n\\n \\t// define __esModule on exports\\n \\t__webpack_require__.r = function(exports) {\\n \\t\\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\\n \\t\\t\\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\\n \\t\\t}\\n \\t\\tObject.defineProperty(exports, '__esModule', { value: true });\\n \\t};\\n\\n \\t// create a fake namespace object\\n \\t// mode & 1: value is a module id, require it\\n \\t// mode & 2: merge all properties of value into the ns\\n \\t// mode & 4: return value when already ns object\\n \\t// mode & 8|1: behave like require\\n \\t__webpack_require__.t = function(value, mode) {\\n \\t\\tif(mode & 1) value = __webpack_require__(value);\\n \\t\\tif(mode & 8) return value;\\n \\t\\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\\n \\t\\tvar ns = Object.create(null);\\n \\t\\t__webpack_require__.r(ns);\\n \\t\\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\\n \\t\\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\\n \\t\\treturn ns;\\n \\t};\\n\\n \\t// getDefaultExport function for compatibility with non-harmony modules\\n \\t__webpack_require__.n = function(module) {\\n \\t\\tvar getter = module && module.__esModule ?\\n \\t\\t\\tfunction getDefault() { return module['default']; } :\\n \\t\\t\\tfunction getModuleExports() { return module; };\\n \\t\\t__webpack_require__.d(getter, 'a', getter);\\n \\t\\treturn getter;\\n \\t};\\n\\n \\t// Object.prototype.hasOwnProperty.call\\n \\t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\\n\\n \\t// __webpack_public_path__\\n \\t__webpack_require__.p = \\\"\\\";\\n\\n\\n \\t// Load entry module and return exports\\n \\treturn __webpack_require__(__webpack_require__.s = 12);\\n\",\"console.log(\\\"TVExtender Content...setting up comms port to background\\\");\\r\\nvar port = chrome.runtime.connect({name: \\\"TVE-comms-port\\\"});\\r\\n\\r\\nimport * as utils from './modules/content_utils.js';\\r\\n\\r\\nport.onMessage.addListener(function(msg, sender) {\\r\\n    if(msg.type == \\\"connAck\\\"){\\r\\n        console.log(msg.payload);\\r\\n        console.log(\\\"Setting up observer...\\\");\\r\\n        var observer= new MutationObserver(function(mutations) {\\r\\n            mutations.forEach(function(mutation) {\\r\\n                if(utils.mutantMatch(mutation)) {\\r\\n                    console.log(mutation); // really useful for debugging!\\r\\n                    mutation.addedNodes.forEach(function(node) {\\r\\n                        // Ensure alert message was generated within the last 1 minute.\\r\\n                        // 1 minute is as granular as alert timestamps get and they seem to\\r\\n                        // be rounded to the nearest minute, this is not foolproof!\\r\\n                        var alertDTS = new Date(node.cells[2].innerText);\\r\\n                        if(utils.withinSeconds(utils.correctTVDTS(alertDTS), 60)) {\\r\\n                            var alertStr = new String(node.cells[1].innerText);\\r\\n                            var order = utils.extractOrder(alertStr);\\r\\n                            if(order != null) {\\r\\n                                // post the order to the background script for further processing\\r\\n                                port.postMessage({type:\\\"order\\\", payload:order});\\r\\n                            } else {\\r\\n                                alert(\\\"Could not extract TVE order from alert, ignoring\\\");\\r\\n                            }\\r\\n                        } else {\\r\\n                            // NOTE: not alerting this error as there will potentially be a lot of\\r\\n                            // these stale alerts i.e. when the site is refreshed within the browser\\r\\n                            // the alert list gets repopulated with all the previous alerts \\r\\n                            // generated in the session\\r\\n                            console.log(\\\"Alert timestamp out of bounds, ignoring\\\");\\r\\n                        }\\r\\n                    });\\r\\n                }\\r\\n            });\\r\\n        });\\r\\n\\r\\n        var rhs = document.getElementsByClassName(\\\"layout__area--right\\\")[0];\\r\\n        var config = {attributes:false, characterData:false, subtree:true, childList:true};\\r\\n        observer.observe(rhs, config);\\r\\n    }\\r\\n});\\r\\n\\r\\n\",\"'use strict';\\r\\n\\r\\n// TradingView gives a datetimestamp in it's alert notifications of the form MMM DD HH:MM\\r\\n// The JS Date constructor assumes a year of 2001 for some reason, so we need to correct\\r\\n// for the current year instead. NOTE: this is something of an assumption as it perfectly possible\\r\\n// that incoming dts was generated in a previous year, however in practice I suspect this is a safe\\r\\n// enough assumption to make!\\r\\nfunction correctTVDTS(tvDTS) {\\r\\n    var corrected = new Date();\\r\\n    corrected.setDate(tvDTS.getDate());\\r\\n    corrected.setHours(tvDTS.getHours());\\r\\n    corrected.setMinutes(tvDTS.getMinutes());\\r\\n    corrected.setSeconds(tvDTS.getSeconds());\\r\\n    return corrected;\\r\\n}\\r\\n\\r\\n// Check if the supplied datetimestamp is within a certain number of seconds of 'now'\\r\\nfunction withinSeconds(dts, seconds) {\\r\\n    var now = new Date();\\r\\n    var dtsDiff = Math.abs(now - dts); \\r\\n    console.log(now);\\r\\n    console.log(dts);\\r\\n    console.log(\\\"DTS Diff: seconds = \\\" + dtsDiff / 1000);\\r\\n    // times are in milliseconds\\r\\n    return (dtsDiff / 1000 >= seconds) ? false : true;\\r\\n}\\r\\n\\r\\n// Extract the TVE order details from a portion of text. TVE order details are bounded by\\r\\n// TVE: and :EVT with the internals being a string rep of a JSON object\\r\\nfunction extractOrder(text) {\\r\\n    var idxS = text.search('TVE:');\\r\\n    var idxE = text.search(':EVT');\\r\\n    if(idxS > -1 && idxE > -1 && idxS + 4 < text.length) {\\r\\n        try {\\r\\n            var order = JSON.parse(text.slice(idxS + 4, idxE));\\r\\n            console.log(order);\\r\\n            return order;\\r\\n        } catch(e) {\\r\\n            console.log(\\\"Error parsing order text: \\\" + e);\\r\\n        }\\r\\n    }\\r\\n    console.log(\\\"Could not find TVE:/:EVT bounds in text: \\\" + text);\\r\\n    return null;\\r\\n}\\r\\n\\r\\n// returns true if the mutation is one we are interested in...\\r\\nfunction mutantMatch(mutation) {\\r\\n    if(mutation.target.localName == 'tbody' \\r\\n            && mutation.target.parentElement.className == 'alert-list' \\r\\n            // This is to differentiate from the alert-list used for alert management\\r\\n            && mutation.target.previousElementSibling.textContent == 'SymbolDescriptionDate/Time') {\\r\\n        return true;\\r\\n    }\\r\\n    return false;\\r\\n}\\r\\n\\r\\nexport {correctTVDTS, withinSeconds, extractOrder, mutantMatch};\\r\\n\"]}","code":"!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=12)}({12:function(e,t,n){var o,r,a;r=[n(13)],void 0===(a=\"function\"==typeof(o=function(e){\"use strict\";var t=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e);console.log(\"TVExtender Content...setting up comms port to background\");var n=chrome.runtime.connect({name:\"TVE-comms-port\"});n.onMessage.addListener(function(e,o){if(\"connAck\"==e.type){console.log(e.payload),console.log(\"Setting up observer...\");var r=new MutationObserver(function(e){e.forEach(function(e){t.mutantMatch(e)&&(console.log(e),e.addedNodes.forEach(function(e){var o=new Date(e.cells[2].innerText);if(t.withinSeconds(t.correctTVDTS(o),60)){var r=new String(e.cells[1].innerText),a=t.extractOrder(r);null!=a?n.postMessage({type:\"order\",payload:a}):alert(\"Could not extract TVE order from alert, ignoring\")}else console.log(\"Alert timestamp out of bounds, ignoring\")}))})}),a=document.getElementsByClassName(\"layout__area--right\")[0];r.observe(a,{attributes:!1,characterData:!1,subtree:!0,childList:!0})}})})?o.apply(t,r):o)||(e.exports=a)},13:function(e,t,n){var o,r,a;r=[t],void 0===(a=\"function\"==typeof(o=function(e){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.correctTVDTS=function(e){var t=new Date;return t.setDate(e.getDate()),t.setHours(e.getHours()),t.setMinutes(e.getMinutes()),t.setSeconds(e.getSeconds()),t},e.withinSeconds=function(e,t){var n=new Date,o=Math.abs(n-e);return console.log(n),console.log(e),console.log(\"DTS Diff: seconds = \"+o/1e3),!(o/1e3>=t)},e.extractOrder=function(e){var t=e.search(\"TVE:\"),n=e.search(\":EVT\");if(t>-1&&n>-1&&t+4<e.length)try{var o=JSON.parse(e.slice(t+4,n));return console.log(o),o}catch(e){console.log(\"Error parsing order text: \"+e)}return console.log(\"Could not find TVE:/:EVT bounds in text: \"+e),null},e.mutantMatch=function(e){return\"tbody\"==e.target.localName&&\"alert-list\"==e.target.parentElement.className&&\"SymbolDescriptionDate/Time\"==e.target.previousElementSibling.textContent}})?o.apply(t,r):o)||(e.exports=a)}});","extractedComments":[]}